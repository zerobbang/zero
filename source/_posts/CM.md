---
title: 혼동 행렬 (Confusion Matrix)
date : "2022-04-06"
categories:
- [Study]
---

### 혼동 행렬

 모델의성능을 평가할 때 사용되는 지표로 예측한 값이 실제값과 비교하여 어떻게 예측했는지 보여주는 행렬이다.  

 보통 이진 분류와 관련있지만 두 개 이상의 클래스가 존재할 때도 혼동 행렬을 사용할 수 있다.  

  기계학습 분야 중에서 통계분류문제에서의 오류 행렬이라고도 부르며 지도 학습에서 알고리즘의 성능을 시각화 할 수 있는 표이다.

   표로 살펴보면 다음과 같다.  

| 실제   \   예상 | True | False |
| --- | --- | --- |
| True | TP | FN |
| False | FP | TN   |

  

→ 실제와 같게 예측한 경우
TP (True Positive) : 실제가 True인데 True로 예측한 경우  →  관심 범주를 정확하게 분류
TN (True Negative) : 실제가 False인데 False로 예측한 경우  →  관심 범주가 아닌것으로 잘못 분류  

→ 실제와 다르게 예측한 경우
FP (False Positive) : 실제가 False인데 True로 예측한 경우  →  관심 범주라고 잘못 분류
FN (False Negative) : 실제가 True인데 False로 예측한 경우  → 관심 번주가 아닌것을 정확하게 분류  
  

- 예 - 자가검사기트(예상) 와 PCR 검사(실제)

| 실제   \   예상 | 양성 | 음성 |
| --- | --- | --- |
| 양성(확진) | 10 | 6 |
| 음성 | 2 | 50 |
  
예측이 잘 된 경우 → 키트 양성, 검사 양성  10명 /  키트 음성, 검사 양성 50명  

예측이 잘못 된 경우 → 키트 양성, 검사 음성 2명  /  키트 음성, 검사 양성 6명  

  
  

- 오분류율

  결과값의 True , False와 상관없이 데이터 세트를 분류 할 때 알고리즘이 잘못 분류한 정도를 의미한다.  

  이는 ( 1 - 정확도 )를 통해 구할 수 있고, 오뷴류율이 낮을 수록 정확도가 높다.  

  
  

- 정밀도 점수

  정밀도는 모델이 참인 값을 얼마나 예측하는 지를 수치화 한 것이다.  

  식으로 보면 다음과 같다.  

  정밀도 = TP / ( TP + FP)  

  TP ( True Positive / 예측, 결과 모두 참)를 결과가 True라고 예측한 값으로 나눈 값으로 모델이 True라고 예측한 값의 정확도라고 볼 수 있다.  
  


- 재현율

  실제 True인 값 중에서 모델이 True라고 정확하게 예측한 정도를 의미한다.  

  재현율 = TP  /  ( TP + FN )
  
  

### 비대칭 오분류 비용

 오분류에서 한 집단의 오분류가 다른 집단의 오분류보다 더 중요할 수도 있다. 그러므로 오분류를 다 같은 중요도로 보면 안된다.  

 예 ) 심장병 위험이 높은 사람을 위험이 낮은 것으로 오분류 하는 비용  ≠  위험이 낮은 사람을 위험이 높은 것으로 오분류 하는 비용  

 그래서 오분류 비용을 통해 서로 다른 유형의 예측 오차의 상대적 중요도를 지정한다.  즉, 오분류 비용은 특정 결과에 적용된 가중치값을 의미한다.  
  


### 분류기준값 Cutoff

  집단에 속할 확률을 구한 후, 이 값과 분류기준값과 비교하여 예측하는데 기본 분류기준값은 0.5로 기준값보다 확률값이 크면 해당 집단에 속한다고 본다. (3개 이상의 집단일 경우 가장 높은 확률를 갖는 집단으로 예측한다.)    

  기준 값을 0.5로만 측정하지 않고 다른 값으로도 설정할 수 있다. 하지만 0.5보다 큰 값이든 작은 값이든 0.5 이외의 값으로 설정하면 오분류비용은 모두 증가하게 된다. 
  그런데도 기준값을 0.5 이외의 값으로 설정하는데 그 이유는 집단 A보다 집단 B를 정확하게 분류하는 것이 더 중요하기 때문에 집단 A에 대한 오분류가 증가해도 이를 허용한다.  
---
참고 : [PPT](http://contents.kocw.net/KOCW/document/2014/Chungbuk/choisanghyun/6.pdf)  

**_<span style="color:#4682B4;"> 이 블로그는 혼자 공부하며 기록하는 블로그로 잘못된 정보에 대한 의견은 격하게 환영합니다.🤩 </span>_**